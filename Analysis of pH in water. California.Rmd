---
title: "Analysis of pH data in water. CA."
author: "Elena Suranova"
date: "2025-03-13"
output:
  pdf_document: default
  html_document: default
---

# üìå –í–≤–µ–¥–µ–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —É—Ä–æ–≤–Ω–∏ pH –≤ –≤–æ–¥–µ, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ –ø–æ–ª–µ–≤—ã—Ö –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π.  
–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö  
- –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è pH  
- –í—ã—è–≤–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤  
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ  
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º–∏  

---

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```{r, message=FALSE, warning=FALSE}
install.packages(c("tidyverse", "data.table", "httr", "lubridate", "dplyr","purrr"))
library(tidyverse)
library(data.table)
library(httr)
library(lubridate)
library(dplyr)
library(purrr)

urls <- c(
  "https://data.cnra.ca.gov/dataset/3f96977e-2597-4baa-8c9b-c433cea0685e/resource/24fc759a-ff0b-479a-a72a-c91a9384540f/download/stations.csv",
  "https://data.cnra.ca.gov/dataset/3f96977e-2597-4baa-8c9b-c433cea0685e/resource/8ff3a841-d843-405a-a360-30c740cc8691/download/period_of_record.csv",  
  "https://data.cnra.ca.gov/dataset/3f96977e-2597-4baa-8c9b-c433cea0685e/resource/a9e7ef50-54c3-4031-8e44-aa46f3c660fe/download/lab_results.csv",
  "https://data.cnra.ca.gov/dataset/3f96977e-2597-4baa-8c9b-c433cea0685e/resource/1911e554-37ab-44c0-89b0-8d7044dd891d/download/field_results.csv"
)

download_and_load <- function(url) {
  temp_file <- tempfile(fileext = ".csv")  #  –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
  GET(url, write_disk(temp_file, overwrite = TRUE))  # –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
  df <- fread(temp_file)  # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ R
  return(df)
}
```


```{r}
data_list <- lapply(urls, download_and_load)  # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∫–æ –≤—Å–µ–º —Å—Å—ã–ª–∫–∞–º

# –†–∞–∑–±–∏—Ä–∞–µ–º —Ñ–∞–π–ª—ã –ø–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
stations <- data_list[[1]]
period_of_record <- data_list[[2]]
lab_results <- data_list[[3]]
field_results <- data_list[[4]]

head(stations)
head(period_of_record)
head(lab_results)
head(field_results)

```

# üîÑ –û—á–∏—Å—Ç–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

```{r}
str(stations)
colSums(is.na(stations))
sum(duplicated(stations))
```
–í—ã–±–∏—Ä–∞—é —Ç–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∏ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –∏ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ö–µ–º—É —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Å–æ–±–æ–π —Ç–∞–±–ª–∏—Ü –Ω–∞ –¥–æ—Å–∫–µ –ú–∏—Ä–æ. 

```{r}
column_names <- colnames(field_results)

# –í—ã–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤ 
print(column_names)


```
```{r}
column_names <- colnames(stations)

# –í—ã–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤
print(column_names)


```

```{r}
column_names <- colnames(period_of_record)

# –í—ã–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤
print(column_names)


```

```{r}
column_names <- colnames(lab_results)

# –í—ã–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç–æ–ª–±—Ü–æ–≤
print(column_names)


```





### 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã –µ—Å—Ç—å –≤ –∫–∞–∂–¥–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ:

```{r}
str(stations)
str(period_of_record)
str(lab_results)
str(field_results)
```
–ò–º–µ–µ—é—Ç—Å—è —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–µ –∫–∞–∫ result, sample_date_min –∏ –¥—Ä.

### –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
–í—ã—à–µ –≤–∏–¥–∏–º, —á—Ç–æ –µ—Å—Ç—å —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∫–∞–∫ —Ç–µ–∫—Å—Ç

```{r}
sapply(stations, class)
sapply(period_of_record, class)
sapply(lab_results, class)
sapply(field_results, class)

```

### 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

–í—ã–≤–µ–¥–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–æ–ª–±—Ü—É:

```{r}
colSums(is.na(stations))
colSums(is.na(period_of_record))
colSums(is.na(lab_results))
colSums(is.na(field_results))
```
–ï—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ latitude, longitude, fdr_result, fdr_date_result, fdr_reporting_limit

### 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
–ï—Å–ª–∏ –µ—Å—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ID), –ø—Ä–æ–≤–µ—Ä–∏–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏:
```{r}
sum(duplicated(stations))
sum(duplicated(period_of_record))
sum(duplicated(lab_results))
sum(duplicated(field_results))
```
–î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ—Ç. 


## –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
###  –î–µ–ª–∞–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã stations
station_id	integer	integer	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å (—ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞–Ω—Ü–∏–∏).
station_name	character	character	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º (–Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏).
full_station_name	character	character	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º.
station_number	character	character	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º.
station_type	character	factor	üîÑ –ú–µ–Ω—è–µ–º –Ω–∞ factor, —Ç–∞–∫ –∫–∞–∫ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Groundwater").
latitude	numeric	numeric	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º (—à–∏—Ä–æ—Ç–∞).
longitude	numeric	numeric	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º (–¥–æ–ª–≥–æ—Ç–∞).
county_name	character	factor	üîÑ –ú–µ–Ω—è–µ–º –Ω–∞ factor, —Ç–∞–∫ –∫–∞–∫ –æ–∫—Ä—É–≥–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.
sample_count	integer	integer	‚úÖ –û—Å—Ç–∞–≤–ª—è–µ–º.
sample_date_min	character	Date (–∏–ª–∏ POSIXct)	üîÑ –ú–µ–Ω—è–µ–º –Ω–∞ Date/POSIXct, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –¥–∞—Ç—ã.
sample_date_max	character	Date (–∏–ª–∏ POSIXct)	üîÑ –ú–µ–Ω—è–µ–º –Ω–∞ Date/POSIXct, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –¥–∞—Ç—ã.

–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º station_type –∏ county_name –≤ factor

```{r}
stations$station_type <- as.factor(stations$station_type)
stations$county_name <- as.factor(stations$county_name)
```

–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º sample_date_min –∏ sample_date_max –≤ —Ñ–æ—Ä–º–∞—Ç Date –∏–ª–∏ POSIXct
–§–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ –¥–∞–Ω–Ω—ã—Ö: "06/23/2008 15:00" ‚Üí mm/dd/yyyy HH:MM
–ò—Å–ø–æ–ª—å–∑—É–µ–º lubridate::mdy_hm() –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ POSIXct (–¥–∞—Ç–∞ + –≤—Ä–µ–º—è):

```{r}  
stations$sample_date_min <- mdy_hm(stations$sample_date_min)
stations$sample_date_max <- mdy_hm(stations$sample_date_max)
```

–ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –∏ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å Date:
```{r} 
stations$sample_date_min <- as.Date(stations$sample_date_min)
stations$sample_date_max <- as.Date(stations$sample_date_max)
```

### –¢–∞–∫–∏–µ –∂–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–æ–∂—É –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∞–±–ª–∏—Ü

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã lab_results

–°—Ç–æ–ª–±–µ—Ü	–¢–µ–∫—É—â–∏–π —Ç–∏–ø	–ù–æ–≤—ã–π —Ç–∏–ø	–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
station_id	integer	integer	‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
station_name	character	character	‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
full_station_name	character	character	‚úÖ –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
station_number	character	character	‚úÖ –ù–æ–º–µ—Ä —Å—Ç–∞–Ω—Ü–∏–∏
station_type	character	factor	üîÑ –¢–∏–ø —Å—Ç–∞–Ω—Ü–∏–∏ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
latitude	numeric	numeric	‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —à–∏—Ä–æ—Ç–∞
longitude	numeric	numeric	‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –¥–æ–ª–≥–æ—Ç–∞
county_name	character	factor	üîÑ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–∫—Ä—É–≥–æ–≤
sample_date	character	Date	üîÑ –î–∞—Ç–∞ –ø—Ä–æ–±—ã
result	character	numeric	üîÑ –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏ –æ—á–∏—â–∞–µ–º –æ—Ç "ND", "Trace")
```{r} 
# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
lab_results$station_type <- as.factor(lab_results$station_type)
lab_results$county_name <- as.factor(lab_results$county_name)

# –û—á–∏—Å—Ç–∫–∞ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–æ–≤
lab_results <- lab_results %>%
  mutate(result = as.numeric(ifelse(result %in% c("ND", "Trace", ""), NA, result))) %>%
  filter(!is.na(result))

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞—Ç
lab_results$sample_date <- as.Date(mdy_hm(lab_results$sample_date))

```

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã field_results

–°—Ç–æ–ª–±–µ—Ü	–¢–µ–∫—É—â–∏–π —Ç–∏–ø	–ù–æ–≤—ã–π —Ç–∏–ø	–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
station_id	integer	integer	‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
station_name	character	character	‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
station_number	character	character	‚úÖ –ù–æ–º–µ—Ä —Å—Ç–∞–Ω—Ü–∏–∏
full_station_name	character	character	‚úÖ –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
station_type	character	factor	üîÑ –¢–∏–ø —Å—Ç–∞–Ω—Ü–∏–∏ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
latitude	numeric	numeric	‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —à–∏—Ä–æ—Ç–∞
longitude	numeric	numeric	‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –¥–æ–ª–≥–æ—Ç–∞
county_name	character	factor	üîÑ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–∫—Ä—É–≥–æ–≤
sample_date	POSIXct	POSIXct	‚úÖ –í—Ä–µ–º—è –ø—Ä–æ–±—ã —É–∂–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
parameter	character	factor	üîÑ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (pH, –∫–∏—Å–ª–æ—Ä–æ–¥ –∏ –¥—Ä.)
fdr_result	numeric	numeric	üîÑ –û—á–∏—â–∞–µ–º –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤

```{r} 
# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
field_results$station_type <- as.factor(field_results$station_type)
field_results$county_name <- as.factor(field_results$county_name)
field_results$parameter <- as.factor(field_results$parameter)

# –û—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è pH-–∑–Ω–∞—á–µ–Ω–∏–π
field_results <- field_results %>%
  mutate(fdr_result = as.numeric(fdr_result)) %>%
  filter(!is.na(fdr_result) & fdr_result > 0 & fdr_result <= 14)

```

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã period_of_record
–ß—Ç–æ –º–µ–Ω—è–µ–º?

–°—Ç–æ–ª–±–µ—Ü	–¢–µ–∫—É—â–∏–π —Ç–∏–ø	–ù–æ–≤—ã–π —Ç–∏–ø	–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
station_id	integer	integer	‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
station_name	character	character	‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
sample_date_min	character	Date	üîÑ –î–∞—Ç–∞ –ø–µ—Ä–≤–æ–π –ø—Ä–æ–±—ã
sample_date_max	character	Date	üîÑ –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–±—ã

```{r} 
# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞—Ç
period_of_record$sample_date_min <- as.Date(mdy_hm(period_of_record$sample_date_min))
period_of_record$sample_date_max <- as.Date(mdy_hm(period_of_record$sample_date_max))

```


## –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –ª–µ—Ç

```{r}
stations <- stations %>% filter(year(sample_date_max) >= 2019)
```

## –ü—Ä–æ–≤–µ—Ä—è—é –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π, —á—Ç–æ–±—ã –æ–Ω–∏ –≤—Ö–æ–¥–∏–ª–∏ –∏–ª–∏ –±—ã–ª–∏ –æ–∫–æ–ª–æ –≤ –≥—Ä–∞–Ω–∏—Ü –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–∏


# üìä –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è pH. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö


–ü–∞—Ä–∞–º–µ—Ç—Ä pH –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö:
field_results ‚Üí –ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è pH (parameter == "pH", fdr_result)
lab_results ‚Üí –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è pH (parameter == "pH", result)

–û—Ç–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä pH
```{r}
field_ph <- field_results %>% filter(parameter == "pH")
```

—è —Ä–µ—à–∏–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –µ—Å—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–¥—ã - 278 —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```{r}
unique_parameters_count <- length(unique(lab_results$parameter))

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
print(unique_parameters_count)
```
—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –µ—Å—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–¥—ã - 65 —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```{r}
unique_parameters_count <- length(unique(field_results$parameter))

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
print(unique_parameters_count)
```
—è —Ä–µ—à–∏–ª–∞ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏ –Ω–∞–π—Ç–∏ –æ–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö lab_results –∏ field_results
```{r}
# –ü–æ–ª—É—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
lab_parameters <- unique(lab_results$parameter)
field_parameters <- unique(field_results$parameter)

# –ü–æ–∏—Å–∫ –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
common_parameters <- intersect(lab_parameters, field_parameters)

# –í—ã–≤–æ–¥ –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
print(common_parameters)

# –í—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
print(length(common_parameters))
```
Conductance (–ü—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å):

–≠—Ç–æ –º–µ—Ä–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã –ø—Ä–æ–≤–æ–¥–∏—Ç—å —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ç–æ–∫. –ü—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞—Å—Ç–≤–æ—Ä–µ–Ω–Ω—ã—Ö –≤ –≤–æ–¥–µ –∏–æ–Ω–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–æ–ª–∏. –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≤—ã—Å–æ–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–ª–µ–π –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ä–∞—Å—Ç–≤–æ—Ä–µ–Ω–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤.
pH:
–≠—Ç–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏–ª–∏ —â–µ–ª–æ—á–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã. –®–∫–∞–ª–∞ pH –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è –æ—Ç 0 –¥–æ 14, –≥–¥–µ 7 ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ó–Ω–∞—á–µ–Ω–∏—è –Ω–∏–∂–µ 7 —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å, –∞ –≤—ã—à–µ 7 ‚Äî –Ω–∞ —â–µ–ª–æ—á–Ω–æ—Å—Ç—å. pH –≤–∞–∂–µ–Ω –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è –≤–æ–¥–Ω—ã—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–∏—Ç—å–µ–≤–æ–π –≤–æ–¥—ã.
Turbidity (–ú—É—Ç–Ω–æ—Å—Ç—å):
–≠—Ç–æ –º–µ—Ä–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã. –ú—É—Ç–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü –≤ –≤–æ–¥–µ, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≥–ª–∏–Ω–∞, –∏–ª –∏–ª–∏ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞. –í—ã—Å–æ–∫–∞—è –º—É—Ç–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –∏–ª–∏ —ç—Ä–æ–∑–∏—é –ø–æ—á–≤—ã.

–≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º —è –ø–ª–∞–Ω–∏—Ä—É—é –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —ç—Ç–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ 2—Ö —Å–ø—Å–æ–±–∞—Ö –∞–Ω–∞–ª–∏–∑–∞ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –∏–ª–∏ –ø–æ–ª–µ–≤—ã–µ.  

## –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH

### –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–µ–≤—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
```{r}
library(ggplot2)

field_ph <- field_results %>% filter(parameter == "pH", !is.na(fdr_result), fdr_result > 0)

ggplot(field_ph, aes(x = fdr_result)) +
  geom_histogram(fill = "blue", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")
```
–ó–¥–µ—Å—å –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ —è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è pH –±—ã–ª–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –æ–∫–æ–ª–æ –Ω—É–ª—è, –∞ –æ—Å—å –• –≤ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å fdr_result –≤ field_results
–ó–Ω–∞—è, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ –Ω–æ—Ä–º–µ pH –≤–æ–¥—ã –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 14. –ù–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –≤–∏–¥–Ω—ã –≤—ã–±—Ä–æ—Å—ã –¥–∞–ª–µ–∫–æ –∑–∞ —ç—Ç–æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω (–¥–æ 200+ –∏ –¥–∞–∂–µ 7000+ –Ω–∞ –ø–µ—Ä–≤–æ–º –≥—Ä–∞—Ñ–∏–∫–µ). –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –Ω–∞–ª–∏—á–∏–∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ –Ω—É–ª–µ–≤—ã—Ö –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
–ü—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫–∏–µ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ fdr_result:

–ù—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```{r}
summary(field_ph$fdr_result)
table(field_ph$fdr_result, useNA = "ifany")  
```
–ü–æ–∫–∞–∂–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ NA  #NA=13
–ú–Ω–æ–≥–æ NA –∏–ª–∏ —Å—Ç—Ä–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0 –¥–ª—è pH ‚Äî —ç—Ç–æ –Ω–µ—Ä–µ–∞–ª—å–Ω–æ), 
!is.na(fdr_result) ‚Äî —É–¥–∞–ª—è—é —Å—Ç—Ä–æ–∫–∏ —Å NA.
fdr_result > 0 ‚Äî —É–±–∏—Ä–∞—é –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
fdr_result <= 14 ‚Äî –æ—Ç—Å–µ–∫–∞—é –≤—ã–±—Ä–æ—Å—ã –≤—ã—à–µ 14.

```{r}
field_ph <- field_results %>% filter(parameter == "pH", !is.na(fdr_result), fdr_result <= 14)
```


### –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
–¢–æ–∂–µ —Å–∞–º–æ–µ –¥–µ–ª–∞—é –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.

```{r}
lab_ph <- lab_results %>% filter(parameter == "pH", !is.na(result), result > 0)
ggplot(lab_ph, aes(x = result)) +
  geom_histogram(fill = "green", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")
```

```{r}
field_ph_clean <- field_ph %>% filter(!is.na(fdr_result) & fdr_result > 0 & fdr_result <= 14)
table(field_ph_clean$fdr_result)  
```

–¢–æ–∂–µ —Å–∞–º–æ–µ —Å–¥–µ–ª–∞–ª–∞ –¥–ª—è lab_results 
ifelse(result %in% c("ND", "Trace", ""), NA, result) ‚Äî –∑–∞–º–µ–Ω–∏–ª–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è (ND, Trace, "") –Ω–∞ NA.
as.numeric() ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∞  result –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç.
!is.na(result) ‚Äî —É–¥–∞–ª–∏–ª–∞ NA.
result > 0 ‚Äî —É–±—Ä–∞–ª–∞ –Ω—É–ª–∏.
result <= 14 ‚Äî –æ—Ç—Å–µ–∫–ª–∞ –≤—ã–±—Ä–æ—Å—ã –≤—ã—à–µ 14.

```{r}
lab_ph_clean <- lab_ph %>%
  mutate(result = as.numeric(ifelse(result %in% c("ND", "Trace", ""), NA, result))) %>%
  filter(!is.na(result) & result > 0 & result <= 14)

```

–ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—é –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
```{r}
ggplot(field_ph_clean, aes(x = pH)) +
  geom_histogram(fill = "blue", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")

ggplot(lab_ph_clean, aes(x = pH)) +
  geom_histogram(fill = "green", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")
```

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π

–û–±—ä–µ–¥–∏–Ω–∏–ª–∞ –¥–≤–∞ –≥—Ä–∞—Ñ–∏–∫–∞ pH –≤ –æ–¥–∏–Ω, —á—Ç–æ–±—ã –Ω–∞–≥–ª—è–¥–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–µ–≤—ã—Ö –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π.
–î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–ª–∞ –µ–¥–∏–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º, –¥–æ–±–∞–≤–∏–≤ –∫–æ–ª–æ–Ω–∫—É source, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∂–µ—Ç, –æ—Ç–∫—É–¥–∞ –≤–∑—è—Ç—ã –¥–∞–Ω–Ω—ã–µ (field –∏–ª–∏ lab).
```{r}
library(ggplot2)
library(dplyr)


# –í —Å–≤—è–∑–∏ —Å —Ç–µ–º, —á—Ç–æ —Å—Ç–æ–ª–±–µ—Ü –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ pH –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ä–∞–∑–Ω–æ–º—É, –ø–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Ö –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
field_ph_clean <- field_ph_clean %>%
  rename(pH = pH) %>%
  mutate(source = "Field")

lab_ph_clean <- lab_ph_clean %>%
  rename(pH = pH) %>%
  mutate(source = "Lab")


# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
combined_ph <- bind_rows(field_ph_clean, lab_ph_clean)

#–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è pH (scatter plot)

ggplot(combined_ph, aes(x = source, y = pH, color = source)) +
  geom_point(alpha = 0.5, position = position_jitter(width = 0.2)) +  
  theme_minimal() +
  labs(title = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è pH",
       x = "–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–º–µ—Ä–µ–Ω–∏–π", y = "pH", color = "–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö") +
  scale_color_manual(values = c("Field" = "blue", "Lab" = "green"))
```
–ó–¥–µ—Å—å —è –±—ã —É–≥–ª—É–±–∏–ª–∞—Å—å –≤ –∞–Ω–∞–ª–∏–∑ –¥–µ–ª—å—Ç—ã –º–µ–∂–¥—É –≤—ã—à–µ –∏ = pH10 –º–µ–∂–¥—É Field –∏ Lab. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ —è –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –º–Ω–æ–≥–æ –ª–µ—Ç —Å–¥–∞–≤–∞–ª–∞ –≤–æ–¥—É –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é –Ω–∞ –∞–Ω–∞–ª–∏–∑ –∏ –∑–Ω–∞—é –≤—Å–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –∑–∞–±–æ—Ä–∞ –≤–æ–¥—ã –∏ –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–≤–æ–∑–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –µ–º–∫–æ—Å—Ç–∏ –≤ –∫–æ—Ç–æ—Ä—É—é —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–æ–±–∞ –≤–æ–¥—ã –Ω–µ–ª—å–∑—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –≤–æ–∑–¥—É—Ö –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—è—é—Ç —Ö–∏–º.—Å–æ—Å—Ç–∞–≤ –≤–æ–¥—ã. –ü–æ—ç—Ç–æ–º—É –∑–¥–µ—Å—å –æ—á–µ–≤–∏–¥–Ω–∞—è –Ω–∞–≥–ª—è–¥–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –∑–∞–≤–∏—Å–∏—Ç —É—Ä–æ–≤–µ–Ω—å pH –æ—Ç —Å–ø–æ—Å–æ–±–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∑–∞–º–µ—Ä–∞.    


–†–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (–¥–≤–∞ —ç–∫—Ä–∞–Ω–∞) !–ù–µ—É–¥–∞—á–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞! –ù–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–æ–∏–ª–æ. 
```{r}
ggplot(combined_ph, aes(x = source, y = pH)) +
  geom_point(alpha = 0.5, color = "black") +
  facet_wrap(~source) +
  theme_minimal() +
  labs(title = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è pH (–ø–æ–ª–µ–≤—ã–µ vs –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)",
       x = "–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–º–µ—Ä–µ–Ω–∏–π", y = "pH")
```


# üìç –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π

## –ö–∞—Ä—Ç–∞ —Å—Ç–∞–Ω—Ü–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```{r}
library(ggplot2)
install.packages("ggmap")
library(ggmap)

ggplot(stations, aes(x = longitude, y = latitude)) +
  geom_point(color = "red", alpha = 0.5, size = 1) +
  theme_minimal() +
  labs(title = "–ö–∞—Ä—Ç–∞ —Å—Ç–∞–Ω—Ü–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ pH", x = "–î–æ–ª–≥–æ—Ç–∞", y = "–®–∏—Ä–æ—Ç–∞")
```
–ù–∞ –ø–æ–ª—É—á–µ–Ω–æ–π –∫–∞—Ä—Ç–µ —è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ —Ç–æ—á–∫—É –¥–∞–ª–µ–∫–æ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–∏
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∏–µ: –®–∏—Ä–æ—Ç–∞ (Latitude): 32.5 ‚Äî 42.0. –î–æ–ª–≥–æ—Ç–∞ (Longitude): -124.5 ‚Äî -114.0, —É–±–µ—Ä–∞—é —Å—Ç—Ä–æ–∫–∏ —Å NA.
–ü—Ä–æ–≤–µ—Ä—è—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —à–∏—Ä–æ—Ç–µ –∏ –¥–æ–ª–≥–æ—Ç–µ
```{r}
summary(stations$latitude)
summary(stations$longitude)

stations <- stations %>% drop_na(latitude, longitude)
```
–§–∏–ª—å—Ç—Ä—É—é –¥–∞–Ω–Ω—ã–µ, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—é
```{r}
stations_clean <- stations %>%
  filter(!is.na(latitude) & !is.na(longitude)) %>%  
  filter(latitude >= 32.5 & latitude <= 42.0, 
         longitude >= -124.5 & longitude <= -114.0)
```

–°—Ç—Ä–æ–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∫–∞—Ä—Ç—É –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤
```{r}
ggplot(stations_clean, aes(x = longitude, y = latitude)) +
  geom_point(color = "blue", alpha = 0.5, size = 1) +
  theme_minimal() +
  labs(title = "–ö–∞—Ä—Ç–∞ —Å—Ç–∞–Ω—Ü–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ pH (–±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤)", 
       x = "–î–æ–ª–≥–æ—Ç–∞", y = "–®–∏—Ä–æ—Ç–∞")
```
```{r}

```



## –ö–∞—Ä—Ç–∞ –ø—Ä–æ–± pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)
```{r}
ggplot(field_ph, aes(x = longitude, y = latitude, color = results)) +
  geom_point(alpha = 0.6, size = 1) +
  scale_color_gradient(low = "blue", high = "red") +
  theme_minimal() +
  labs(title = "–ö–∞—Ä—Ç–∞ –ø—Ä–æ–± pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "–î–æ–ª–≥–æ—Ç–∞", y = "–®–∏—Ä–æ—Ç–∞")
```


#üìè –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º–∏

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "–í –Ω–æ—Ä–º–µ" / "–í–Ω–µ –Ω–æ—Ä–º—ã"
```{r}
field_ph <- field_ph %>% mutate(norm_status = ifelse(pH >= 6.5 & pH <= 8.5, "–í –Ω–æ—Ä–º–µ", "–í–Ω–µ –Ω–æ—Ä–º—ã"))
lab_ph <- lab_ph %>% mutate(norm_status = ifelse(pH >= 6.5 & pH <= 8.5, "–í –Ω–æ—Ä–º–µ", "–í–Ω–µ –Ω–æ—Ä–º—ã"))
```

## –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–± –≤–Ω–µ –Ω–æ—Ä–º—ã
```{r}
field_outliers <- sum(field_ph$norm_status == "–í–Ω–µ –Ω–æ—Ä–º—ã") / nrow(field_ph) * 100
lab_outliers <- sum(lab_ph$norm_status == "–í–Ω–µ –Ω–æ—Ä–º—ã") / nrow(lab_ph) * 100

cat("–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–± –≤–Ω–µ –Ω–æ—Ä–º—ã (–ø–æ–ª–µ–≤—ã–µ):", round(field_outliers, 2), "%\n")
cat("–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–± –≤–Ω–µ –Ω–æ—Ä–º—ã (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ):", round(lab_outliers, 2), "%\n")
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞–Ω–∏—Ü –Ω–æ—Ä–º—ã pH
```{r}
ggplot(field_ph, aes(x = pH, fill = norm_status)) +
  geom_histogram(bins = 30, alpha = 0.7, color = "black") +
  geom_vline(xintercept = c(6.5, 8.5), linetype = "dashed", color = "black", size = 1) +
  theme_minimal()
```


# üìå –í—ã–≤–æ–¥—ã

















## –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –ª–µ—Ç

```{r}
stations <- stations %>% filter(year(sample_date_max) >= 2019)
```

## –ü—Ä–æ–≤–µ—Ä—è—é –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Å–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π, —á—Ç–æ–±—ã –æ–Ω–∏ –≤—Ö–æ–¥–∏–ª–∏ –∏–ª–∏ –±—ã–ª–∏ –æ–∫–æ–ª–æ –≤ –≥—Ä–∞–Ω–∏—Ü –ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏–∏


# üìä –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è pH. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö


# –û—á–∏—Å—Ç–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è pH-–∑–Ω–∞—á–µ–Ω–∏–π
field_results <- field_results %>%
  mutate(fdr_result = as.numeric(fdr_result)) %>%
  filter(!is.na(fdr_result) & fdr_result > 0 & fdr_result <= 14)



–ü–∞—Ä–∞–º–µ—Ç—Ä pH –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö:
field_results ‚Üí –ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è pH (parameter == "pH", fdr_result)
lab_results ‚Üí –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è pH (parameter == "pH", result)

–û—Ç–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä pH
```{r}
field_ph <- field_results %>% filter(parameter == "pH")
```

—è —Ä–µ—à–∏–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –µ—Å—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–¥—ã - 278 —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```{r}
unique_parameters_count <- length(unique(lab_results$parameter))

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
print(unique_parameters_count)
```
—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –µ—Å—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–¥—ã - 65 —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```{r}
unique_parameters_count <- length(unique(field_results$parameter))

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
print(unique_parameters_count)
```
—è —Ä–µ—à–∏–ª–∞ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏ –Ω–∞–π—Ç–∏ –æ–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö lab_results –∏ field_results
```{r}
# –ü–æ–ª—É—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
lab_parameters <- unique(lab_results$parameter)
field_parameters <- unique(field_results$parameter)

# –ü–æ–∏—Å–∫ –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
common_parameters <- intersect(lab_parameters, field_parameters)

# –í—ã–≤–æ–¥ –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
print(common_parameters)

# –í—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
print(length(common_parameters))
```
Conductance (–ü—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å):

–≠—Ç–æ –º–µ—Ä–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã –ø—Ä–æ–≤–æ–¥–∏—Ç—å —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ç–æ–∫. –ü—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞—Å—Ç–≤–æ—Ä–µ–Ω–Ω—ã—Ö –≤ –≤–æ–¥–µ –∏–æ–Ω–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–æ–ª–∏. –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –≤—ã—Å–æ–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–ª–µ–π –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ä–∞—Å—Ç–≤–æ—Ä–µ–Ω–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤.
pH:
–≠—Ç–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏–ª–∏ —â–µ–ª–æ—á–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã. –®–∫–∞–ª–∞ pH –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è –æ—Ç 0 –¥–æ 14, –≥–¥–µ 7 ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ó–Ω–∞—á–µ–Ω–∏—è –Ω–∏–∂–µ 7 —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å, –∞ –≤—ã—à–µ 7 ‚Äî –Ω–∞ —â–µ–ª–æ—á–Ω–æ—Å—Ç—å. pH –≤–∞–∂–µ–Ω –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è –≤–æ–¥–Ω—ã—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–∏—Ç—å–µ–≤–æ–π –≤–æ–¥—ã.
Turbidity (–ú—É—Ç–Ω–æ—Å—Ç—å):
–≠—Ç–æ –º–µ—Ä–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –≤–æ–¥—ã. –ú—É—Ç–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü –≤ –≤–æ–¥–µ, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≥–ª–∏–Ω–∞, –∏–ª –∏–ª–∏ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞. –í—ã—Å–æ–∫–∞—è –º—É—Ç–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –∏–ª–∏ —ç—Ä–æ–∑–∏—é –ø–æ—á–≤—ã.

–≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º —è –ø–ª–∞–Ω–∏—Ä—É—é –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —ç—Ç–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ 2—Ö —Å–ø—Å–æ–±–∞—Ö –∞–Ω–∞–ª–∏–∑–∞ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –∏–ª–∏ –ø–æ–ª–µ–≤—ã–µ.  

## –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH

### –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª–µ–≤—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
```{r}
library(ggplot2)

field_ph <- field_results %>% filter(parameter == "pH", !is.na(fdr_result), fdr_result > 0)

ggplot(field_ph, aes(x = fdr_result)) +
  geom_histogram(fill = "blue", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")
```
–ó–¥–µ—Å—å –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ —è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è pH –±—ã–ª–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –æ–∫–æ–ª–æ –Ω—É–ª—è, –∞ –æ—Å—å –• –≤ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å fdr_result –≤ field_results
–ó–Ω–∞—è, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ –Ω–æ—Ä–º–µ pH –≤–æ–¥—ã –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 14. –ù–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –≤–∏–¥–Ω—ã –≤—ã–±—Ä–æ—Å—ã –¥–∞–ª–µ–∫–æ –∑–∞ —ç—Ç–æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω (–¥–æ 200+ –∏ –¥–∞–∂–µ 7000+ –Ω–∞ –ø–µ—Ä–≤–æ–º –≥—Ä–∞—Ñ–∏–∫–µ). –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –Ω–∞–ª–∏—á–∏–∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ –Ω—É–ª–µ–≤—ã—Ö –∏–ª–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
–ü—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫–∏–µ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ fdr_result:

–ù—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
```{r}
summary(field_ph$fdr_result)
table(field_ph$fdr_result, useNA = "ifany")  
```
–ü–æ–∫–∞–∂–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ NA  #NA=13
–ú–Ω–æ–≥–æ NA –∏–ª–∏ —Å—Ç—Ä–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0 –¥–ª—è pH ‚Äî —ç—Ç–æ –Ω–µ—Ä–µ–∞–ª—å–Ω–æ), 
!is.na(fdr_result) ‚Äî —É–¥–∞–ª—è—é —Å—Ç—Ä–æ–∫–∏ —Å NA.
fdr_result > 0 ‚Äî —É–±–∏—Ä–∞—é –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
fdr_result <= 14 ‚Äî –æ—Ç—Å–µ–∫–∞—é –≤—ã–±—Ä–æ—Å—ã –≤—ã—à–µ 14.

```{r}
field_ph <- field_results %>% filter(parameter == "pH", !is.na(fdr_result), fdr_result <= 14)
```


### –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
–¢–æ–∂–µ —Å–∞–º–æ–µ –¥–µ–ª–∞—é –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π.

```{r}
lab_ph <- lab_results %>% filter(parameter == "pH", !is.na(result), result > 0)
ggplot(lab_ph, aes(x = result)) +
  geom_histogram(fill = "green", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")
```

```{r}
field_ph_clean <- field_ph %>% filter(!is.na(fdr_result) & fdr_result > 0 & fdr_result <= 14)
table(field_ph_clean$fdr_result)  
```

–¢–æ–∂–µ —Å–∞–º–æ–µ —Å–¥–µ–ª–∞–ª–∞ –¥–ª—è lab_results 
ifelse(result %in% c("ND", "Trace", ""), NA, result) ‚Äî –∑–∞–º–µ–Ω–∏–ª–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è (ND, Trace, "") –Ω–∞ NA.
as.numeric() ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∞  result –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç.
!is.na(result) ‚Äî —É–¥–∞–ª–∏–ª–∞ NA.
result > 0 ‚Äî —É–±—Ä–∞–ª–∞ –Ω—É–ª–∏.
result <= 14 ‚Äî –æ—Ç—Å–µ–∫–ª–∞ –≤—ã–±—Ä–æ—Å—ã –≤—ã—à–µ 14.

```{r}
lab_ph_clean <- lab_ph %>%
  mutate(result = as.numeric(ifelse(result %in% c("ND", "Trace", ""), NA, result))) %>%
  filter(!is.na(result) & result > 0 & result <= 14)

```

–ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—é –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
```{r}
ggplot(field_ph_clean, aes(x = pH)) +
  geom_histogram(fill = "blue", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")

ggplot(lab_ph_clean, aes(x = pH)) +
  geom_histogram(fill = "green", bins = 30, alpha = 0.7, color = "black") +
  theme_minimal() +
  labs(title = "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ pH (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "pH", y = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±")
```

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π

–û–±—ä–µ–¥–∏–Ω–∏–ª–∞ –¥–≤–∞ –≥—Ä–∞—Ñ–∏–∫–∞ pH –≤ –æ–¥–∏–Ω, —á—Ç–æ–±—ã –Ω–∞–≥–ª—è–¥–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–µ–≤—ã—Ö –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π.
–î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–ª–∞ –µ–¥–∏–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º, –¥–æ–±–∞–≤–∏–≤ –∫–æ–ª–æ–Ω–∫—É source, –∫–æ—Ç–æ—Ä–∞—è —É–∫–∞–∂–µ—Ç, –æ—Ç–∫—É–¥–∞ –≤–∑—è—Ç—ã –¥–∞–Ω–Ω—ã–µ (field –∏–ª–∏ lab).
```{r}
library(ggplot2)
library(dplyr)


# –í —Å–≤—è–∑–∏ —Å —Ç–µ–º, —á—Ç–æ —Å—Ç–æ–ª–±–µ—Ü –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ pH –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ä–∞–∑–Ω–æ–º—É, –ø–µ—Ä–µ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Ö –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
field_ph_clean <- field_ph_clean %>%
  rename(pH = pH) %>%
  mutate(source = "Field")

lab_ph_clean <- lab_ph_clean %>%
  rename(pH = pH) %>%
  mutate(source = "Lab")


# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
combined_ph <- bind_rows(field_ph_clean, lab_ph_clean)

#–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è pH (scatter plot)

ggplot(combined_ph, aes(x = source, y = pH, color = source)) +
  geom_point(alpha = 0.5, position = position_jitter(width = 0.2)) +  
  theme_minimal() +
  labs(title = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è pH",
       x = "–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–º–µ—Ä–µ–Ω–∏–π", y = "pH", color = "–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö") +
  scale_color_manual(values = c("Field" = "blue", "Lab" = "green"))
```
–ó–¥–µ—Å—å —è –±—ã —É–≥–ª—É–±–∏–ª–∞—Å—å –≤ –∞–Ω–∞–ª–∏–∑ –¥–µ–ª—å—Ç—ã –º–µ–∂–¥—É –≤—ã—à–µ –∏ = pH10 –º–µ–∂–¥—É Field –∏ Lab. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ —è –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –º–Ω–æ–≥–æ –ª–µ—Ç —Å–¥–∞–≤–∞–ª–∞ –≤–æ–¥—É –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é –Ω–∞ –∞–Ω–∞–ª–∏–∑ –∏ –∑–Ω–∞—é –≤—Å–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –∑–∞–±–æ—Ä–∞ –≤–æ–¥—ã –∏ –≤—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–≤–æ–∑–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –µ–º–∫–æ—Å—Ç–∏ –≤ –∫–æ—Ç–æ—Ä—É—é —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–æ–±–∞ –≤–æ–¥—ã –Ω–µ–ª—å–∑—è –æ—Å—Ç–∞–≤–ª—è—Ç—å –≤–æ–∑–¥—É—Ö –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—è—é—Ç —Ö–∏–º.—Å–æ—Å—Ç–∞–≤ –≤–æ–¥—ã. –ü–æ—ç—Ç–æ–º—É –∑–¥–µ—Å—å –æ—á–µ–≤–∏–¥–Ω–∞—è –Ω–∞–≥–ª—è–¥–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫ –∑–∞–≤–∏—Å–∏—Ç —É—Ä–æ–≤–µ–Ω—å pH –æ—Ç —Å–ø–æ—Å–æ–±–∞ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∑–∞–º–µ—Ä–∞.    


–†–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (–¥–≤–∞ —ç–∫—Ä–∞–Ω–∞) !–ù–µ—É–¥–∞—á–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞! –ù–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–æ–∏–ª–æ. 
```{r}
ggplot(combined_ph, aes(x = source, y = pH)) +
  geom_point(alpha = 0.5, color = "black") +
  facet_wrap(~source) +
  theme_minimal() +
  labs(title = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è pH (–ø–æ–ª–µ–≤—ã–µ vs –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)",
       x = "–ò—Å—Ç–æ—á–Ω–∏–∫ –∏–∑–º–µ—Ä–µ–Ω–∏–π", y = "pH")
```





## –ö–∞—Ä—Ç–∞ –ø—Ä–æ–± pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)
```{r}
ggplot(field_ph, aes(x = longitude, y = latitude, color = results)) +
  geom_point(alpha = 0.6, size = 1) +
  scale_color_gradient(low = "blue", high = "red") +
  theme_minimal() +
  labs(title = "–ö–∞—Ä—Ç–∞ –ø—Ä–æ–± pH (–ø–æ–ª–µ–≤—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è)", x = "–î–æ–ª–≥–æ—Ç–∞", y = "–®–∏—Ä–æ—Ç–∞")
```


#üìè –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º–∏

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "–í –Ω–æ—Ä–º–µ" / "–í–Ω–µ –Ω–æ—Ä–º—ã"
```{r}
field_ph <- field_ph %>% mutate(norm_status = ifelse(pH >= 6.5 & pH <= 8.5, "–í –Ω–æ—Ä–º–µ", "–í–Ω–µ –Ω–æ—Ä–º—ã"))
lab_ph <- lab_ph %>% mutate(norm_status = ifelse(pH >= 6.5 & pH <= 8.5, "–í –Ω–æ—Ä–º–µ", "–í–Ω–µ –Ω–æ—Ä–º—ã"))
```

## –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–± –≤–Ω–µ –Ω–æ—Ä–º—ã
```{r}
field_outliers <- sum(field_ph$norm_status == "–í–Ω–µ –Ω–æ—Ä–º—ã") / nrow(field_ph) * 100
lab_outliers <- sum(lab_ph$norm_status == "–í–Ω–µ –Ω–æ—Ä–º—ã") / nrow(lab_ph) * 100

cat("–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–± –≤–Ω–µ –Ω–æ—Ä–º—ã (–ø–æ–ª–µ–≤—ã–µ):", round(field_outliers, 2), "%\n")
cat("–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–æ–± –≤–Ω–µ –Ω–æ—Ä–º—ã (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ):", round(lab_outliers, 2), "%\n")
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞–Ω–∏—Ü –Ω–æ—Ä–º—ã pH
```{r}
ggplot(field_ph, aes(x = pH, fill = norm_status)) +
  geom_histogram(bins = 30, alpha = 0.7, color = "black") +
  geom_vline(xintercept = c(6.5, 8.5), linetype = "dashed", color = "black", size = 1) +
  theme_minimal()
```


# üìå –í—ã–≤–æ–¥—ã

















